<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Minhas Viagens</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* CSS para o Footer ficar em baixo */
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
  </style>
</head>
<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="container mt-4 pb-5">
  <h2 class="mb-4">Histórico de Viagens</h2>

  <div class="card shadow-sm border-0">
    <div class="card-body p-0">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Veículo ID</th>
          <th>Início</th>
          <th>Fim</th>
          <th>Preço</th> <th>Estado</th>
          <th class="text-end">Ação</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="trip : ${viagens}">
          <td th:text="${trip.id}">1</td>
          <td th:text="${trip.vehicleId}">10</td>

          <td th:text="${#temporals.format(trip.startTime, 'dd/MM/yyyy HH:mm')}">Data</td>
          <td th:text="${trip.endTime != null} ? ${#temporals.format(trip.endTime, 'dd/MM/yyyy HH:mm')} : '--'">--</td>

          <td>
             <span th:if="${trip.totalPrice != null and trip.totalPrice > 0}"
                   th:text="${#numbers.formatCurrency(trip.totalPrice)}"
                   class="fw-bold text-dark">
             </span>
              <span th:if="${trip.totalPrice == null or trip.totalPrice == 0}" class="text-muted small">
                    (A calcular...)
              </span>
          </td>

          <td>
            <span th:if="${trip.active}" class="badge bg-success">Em Curso</span>
            <span th:unless="${trip.active}" class="badge bg-secondary">Terminada</span>
          </td>
          <td class="text-end">
            <a th:if="${trip.active}" th:href="@{/stop-rental/{id}(id=${trip.id})}" class="btn btn-danger btn-sm">Terminar</a>
            <span th:unless="${trip.active}" class="text-success fw-bold"><i class="fa-solid fa-check"></i> Pago</span>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<footer class="bg-dark text-white text-center py-3 mt-auto">
  <div class="container">
    <small>&copy; 2026 IPCB Rental Services. Todos os direitos reservados.</small>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>